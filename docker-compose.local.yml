version: '3'
services:
  api-gateway-container:
    build:
      context: ./api-gateway
      dockerfile: Dockerfile
    image: ecommerce-api-gateway:local
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=dev
      - SPRING_ZIPKIN_BASE_URL=http://zipkin:9411
      - SPRING_CONFIG_IMPORT=optional:configserver:http://cloud-config-container:9296/
      - SPRING_CLOUD_CONFIG_URI=http://cloud-config-container:9296
      - EUREKA_CLIENT_SERVICEURL_DEFAULTZONE=http://service-discovery-container:8761/eureka/
    networks:
      - microservices_network

  proxy-client-container:
    build:
      context: ./proxy-client
      dockerfile: Dockerfile
    image: ecommerce-proxy-client:local
    ports:
      - "8900:8900"
    networks:
      - microservices_network

  service-discovery-container:
    build:
      context: ./service-discovery
      dockerfile: Dockerfile
    image: ecommerce-service-discovery:local
    ports:
      - "8761:8761"
    networks:
      - microservices_network

  cloud-config-container:
    build:
      context: ./cloud-config
      dockerfile: Dockerfile
    image: ecommerce-cloud-config:local
    ports:
      - "9296:9296"
    networks:
      - microservices_network

  user-service-container:
    build:
      context: ./user-service
      dockerfile: Dockerfile
    image: ecommerce-user-service:local
    ports:
      - "8700:8700"
    networks:
      - microservices_network

  product-service-container:
    build:
      context: ./product-service
      dockerfile: Dockerfile
    image: ecommerce-product-service:local
    ports:
      - "8500:8500"
    networks:
      - microservices_network

  favourite-service-container:
    build:
      context: ./favourite-service
      dockerfile: Dockerfile
    image: ecommerce-favourite-service:local
    ports:
      - "8800:8800"
    networks:
      - microservices_network

  order-service-container:
    build:
      context: ./order-service
      dockerfile: Dockerfile
    image: ecommerce-order-service:local
    ports:
      - "8300:8300"
    networks:
      - microservices_network

  payment-service-container:
    build:
      context: ./payment-service
      dockerfile: Dockerfile
    image: ecommerce-payment-service:local
    ports:
      - "8400:8400"
    networks:
      - microservices_network

  shipping-service-container:
    build:
      context: ./shipping-service
      dockerfile: Dockerfile
    image: ecommerce-shipping-service:local
    ports:
      - "8600:8600"
    networks:
      - microservices_network

networks:
  microservices_network:
    driver: bridge
